.TH ENCODER "9" "2007-01-16" "EMC Documentation" "HAL Component"
.de TQ
.br
.ns
.TP \\$1
..

.SH NAME
encoder \- software counting of quadrature encoder signals
.SH SYNOPSIS
\fBloadrt encoder num_chan=\fInum\fR

.SH DESCRIPTION
\fBencoder\fR is used to measure position by counting the pulses
generated by a quadrature encoder.  As a software based implementation
it is much less expensive than hardware, but has a limited maximum
count rate.  The limit is in the range of 10KHz to 50KHz, depending
on the computer speed and other factors.  If better performance is
needed, a hardware encoder counter is a better choice.  Some hardware
based systems can count at MHz rates.
.P
\fBencoder\fR supports a maximum of eight channels.  The number of
channels actually loaded is set by the \fBnum_chan\fR argument when
the module is loaded.  If \fBnumchan\fR is not specified, the default
value is three.

.SH FUNCTIONS
.TP 
\fBupdate-counters\fR (no floating-point)
Does the actual counting, by sampling the encoder signals and decoding
the quadrature waveforms.  Must be called as frequently as possible,
preferrably twice as fast as the maximum desired count rate.
.TP
\fBcapture-position\fR (uses floating point)
Captures the raw counts from \fBupdate-counters\fR and performs scaling
and other neccessary conversion, handles counter rollover, etc.  Can
(and should) be called less frequently than \fBupdate-counters\fR.

.SH PINS
.TP
\fBphase-A\fR bit in
Quadrature input.
.TP
\fBphase-B\fR bit in
Quadrature input.
.TP
\fBphase-Z\fR bit in
Index pulse input.
.TP
\fBreset\fR bit in
When true, \fBcounts\fR and \fBposition\fR are reset to zero immediately.
.TP
\fBindex-enable\fR bit i/o
When true, \fBcounts\fR and \fBposition\fR are reset to zero on the next
rising edge of \fBPhase-Z\fR.  At the same time, \fBindex-enable\fR is reset
to zero to indicate that the rising edge has occurred.
.TP
\fBcounts\fR s32 out
Position in encoder counts.
.TP
\fBposition\fR float out
Position in scaled units (see \fBposition-scale\fR)
.TP
\fBvelocity\fR float out
Velocity in scaled units per second.

.SH PARAMETERS
.TP
\fBposition-scale\fR float rw
Scale factor, in counts per length unit.  For example, if \fBposition-scale\fR
is 500, then 1000 counts of the encoder will be reported as a postion of 2.0
units.
.TP
\fBx4-mode\fR bit rw
Enables times-4 mode.  When true (the default), the counter counts each edge
of the quadrature waveform (four counts per full cycle).  When false, it only
counts once per full cycle.
.TP
\fBrawcounts\fR s32 ro
The raw count, as determined by \fBupdate-counters\fR.  This value is updated
more frequently than \fBcounts\fR and \fBposition\fR.

.SH
SEE ALSO
\fBcounter(9)\fR

