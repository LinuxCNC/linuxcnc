== Libraries modules

libraries are prebuilt python modules that give added features to QTvcp. +
In this way you can select what features you want - yet don't have to build common ones yourself. +

=== STATUS

STATUS is a library that sends GObject messages based on linuxcnc's current state. +
It is an extension of gladevcp's GStat object. +
It also has some functions to do things such as jogging. +
You connect a function call to the STATUS message you are interested in. +
QTvcp will call this function when the message is sent from STATUS. +

To import this modules add this python code to your import section: +
[source,python]
----
from qtvcp.core import Status
----
To instantiate the module so you can use it add this python code to your instantiate section: +
[source,python]
----
STATUS = Status()
----
To connect to messages use GObject syntax. For example to catch machine on and off messages, +
place these commands into the INITIALIZE section: +
[source,python]
----
        STATUS.connect('state-on', self.on_state_on)
        STATUS.connect('state-off', self.on_state_off)
----
In this example code when linuxcnc is in machine on state the function self.on_state_on will be called. +
When linuxcnc is in machine off state the function self.on_state_off will be called. +

=== IStat

IStat is a library to collect and filters data from the INI file. +

The available data and defaults: +
----
inifile = linuxcnc.ini(INIPATH) +
MDI_HISTORY_PATH = '~/.axis_mdi_history' +
PREFERENCE_PATH = '~/.Preferences' +
SUB_PATH = None +
PROGRAM_FILTERS = None +
PARAMETER_FILE = None +
MACHINE_IS_LATHE = False +
MACHINE_IS_METRIC = False +
MACHINE_UNIT_CONVERSION = 1 +
MACHINE_UNIT_CONVERSION_9 = [1]*9 +
AVAILABLE_AXES = ('X','Y','Z') +
AVAILABLE_AXES_INT = (0,1,2) +
NO_HOME_REQUIRED = False +
JOG_INCREMENTS = None +
ANGULAR_INCREMENTS = None +
 +
MAX_LINEAR_VELOCITY = 60 +
DEFAULT_LINEAR_VELOCITY = 15.0 +
 +
DEFAULT_SPINDLE_SPEED = 200 +
MAX_FEED_OVERRIDE = 1.5 +
MAX_SPINDLE_OVERRIDE = 1.5 +
MIN_SPINDLE_OVERRIDE = 0.5 +

# user message dialog info +
USRMESS_BOLDTEXT = +
USRMESS_TEXT = +
USRMESS_TYPE = +
USRMESS_PINNAME = +
USRMESS_DETAILS = +
USRMESS_ICON = +
ZIPPED_USRMESS = +

# embeded program info +
TAB_NAMES = +
TAB_LOCATION = +
TAB_CMD = +
----
There are some 'helper functions' - mostly used for widget support +
----
convert_units(self, data)
convert_units_9(self,data):
get_filter_program(self, fname):
get_qt_filter_extensions(self,):
----
To import this modules add this python code to your import section: +
[source,python]
----
from qtvcp.qt_istat import IStat
----
To instantiate the module so you can use it in a handler file add this python code to your instantiate section: +
[source,python]
----
INI = IStat()
----
To access IStat data use this general syntax  +
[source,python]
----
home_state = INI.NO_HOME_REQUIRED
if INI.MACHINE_IS_METRIC is True:
    print 'Metric based'
----

=== Lcnc_Action

This library is used to command linuxcnc's motion controller. +
It tries to hide incidental details and add convenience methods to developers. +

To import this modules add this python code to your import section: +
[source,python]
----
from qtvcp.qt_glib import Lcnc_Action
----
To instantiate the module so you can use it add this python code to your instantiate section: +
[source,python]
----
ACTION = Lcnc_Action()
----
To access Lcnc_Action commands use general syntax such as these: +
[source,python]
----
ACTION.SET_ESTOP_STATE(state)
ACTION.SET_MACHINE_STATE(state)
ACTION.SET_AUTO_MODE()
ACTION.RUN()
----

=== aux_program_loader

This module allows an easy way to load auxiliary programs linuxcnc often uses. +
To import this modules add this python code to your import section: +
[source,python]
----
from qtvcp.lib.aux_program_loader import Aux_program_loader
----
To instantiate the module so you can use it add this python code to your instantiated section: +
[source,python]
----
AUX_PRGM = Aux_program_loader() +
----

==== HALmeter

----
    Halmeter is used to display one HAL pin data.
    load a halmeter with AUX_PRGM.load_halmeter()
----

==== classicladder user program

Todo

==== linuxcnc status program

Todo

==== HALshow configure display program

Todo

==== HALscope program

Todo

==== tooledit program

Todo

==== calibration

Todo

==== onboard/matchbox keyboard

Todo

=== Keybindings

This module is used to allow each keypress to control a behavior such as jogging.
It's used inside the handler file to facilitate keyboard jogging etc.+

=== Messages

This modules is used to display pop up dialog messages on the screen.+
These are defined in the INI file and controlled by HAL pins.+
'Boldtext' is generally a title.
'text' is below that and usually longer.+
'Detail' is hidden unless clicked on.+
'pinname' is the basename of the HAL pins.+
'type' specifies whether its a yes/no, ok, or status message.+
Status messages will be shown in the status bar and the notify dialog.+
it requires no user intervention.+
ok messages require the user to click ok to close the dialog.+
ok messages have one HAL pin to launch the dialog and one to signify it's waiting 
for response.+
yes/no messages require the user to select yes or no buttons to close the dialog.+
yes/no messages have three hal pins - one to show the dialog, one for waiting,+
and one for the answer.+
By default it will send STATUS messages for focus_overlay anf alert sound.+
These will silently fail if those options are not set up.+

Here is a sample INI code. It would be under the [DISPLAY] heading.+

[source,{ini}]
----
# This just shows in the status bar and desktop notify popup.
MESSAGE_BOLDTEXT = NONE
MESSAGE_TEXT = This is a statusbar test
MESSAGE_DETAILS = STATUS DETAILS
MESSAGE_TYPE = status
MESSAGE_PINNAME = statustest

# This will pop up a dialog that asks a yes no question
MESSAGE_BOLDTEXT = NONE
MESSAGE_TEXT = This is a yes no dialog test
MESSAGE_DETAILS = Y/N DETAILS
MESSAGE_TYPE = yesnodialog
MESSAGE_PINNAME = yndialogtest

# This pops up a dialog that requires an ok response and it shows in the status bar and
# the destop notify popup.
MESSAGE_BOLDTEXT = This is the short text
MESSAGE_TEXT = This is the longer text of the both type test. It can be longer then the status bar text
MESSAGE_DETAILS = BOTH DETAILS
MESSAGE_TYPE = okdialog status
MESSAGE_PINNAME = bothtest
----
The screenoptions widget can automatically set up the message system.+
=== notify

This module is used to send messages that are integrated into the desktop.+
it uses the pynotify library.+

Ubuntu does not follow the standard - you can't set how long the message stays up for.+
I suggest fixing this with a PPA off the net+
 https://launchpad.net/~leolik/+archive/leolik?field.series_filter=lucid+

you can set the title, message, icon, and timeout.+
Notify keeps a list of all the alarm messages since starting in self.alarmpage .+
If you click 'show all messages' in the notify popup, it will print then to the terminal.+

The sceenoptions widget can automatically set up the notify system.+

=== preferences

This module allows one to load and save preference data permanently to storage media.+
+
The sceenoptions widget can automatically set up the preference system.+
qtvcp searches for the screenoption widget first and if found calls _pref_init().+
This will create the preference object and return it to qtvcp to pass to all the widgets and
 add it to the window object attributes. In this case the preferences object would be accesable 
from the handler file's initialized_ method as self.w.PREFS_+
Also all widgets can have access to a specific preference file at initialization time.+

=== audio player

This module allows playing non-blocking sounds using gstreamer.+
There are default alert sounds using Mint or freedesktop default sounds.+
You can play arbitrary sounds or even songs by specifying the path.+
STATUS has messages to control this module.+
The screenoptions widget can automatically set up the audio system.+

=== virtual keyboard

This library allows you to use STATUS messages to launch a virtual keyboard.+
It uses onboard or matchbox library for the keyboard.+
